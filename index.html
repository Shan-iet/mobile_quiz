<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Exam Engine Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="app-container">
  <main class="main-content">
    
    <div id="home" class="card">
      <h1 class="hero-title">ğŸ“˜ Quiz Manager</h1>
      <div class="action-grid">
        <div class="action-card">
          <h3>ğŸ†• Start Fresh</h3>
          <label for="fileInput" class="custom-file-upload"><span id="fileNameDisplay">Select Quiz JSON</span></label>
          <input type="file" id="fileInput" accept=".json" onchange="updateFileName(this, 'fileNameDisplay')">
          
          <div class="settings-group">
             <div class="input-row">
                <div class="input-wrap">
                    <label>Marks (+)</label>
                    <input type="number" id="markInput" placeholder="Default" step="0.1">
                </div>
                <div class="input-wrap">
                    <label>Penalty (-)</label>
                    <input type="number" id="negInput" placeholder="Default" step="0.1">
                </div>
             </div>
             <div class="checkbox-wrapper">
                <input type="checkbox" id="shuffleToggle">
                <label for="shuffleToggle">ğŸ”€ Shuffle Questions</label>
             </div>
          </div>

          <button class="btn btn-primary btn-full" onclick="startNewSession()">Start Quiz</button>
        </div>

        <div class="action-card">
          <h3>ğŸ“‚ Resume Progress</h3>
          <label for="importInput" class="custom-file-upload"><span id="syncNameDisplay">Import Sync File</span></label>
          <input type="file" id="importInput" accept=".json" onchange="updateFileName(this, 'syncNameDisplay')">
          <button class="btn btn-primary btn-full" onclick="importSyncFileManual()">Resume</button>
        </div>
      </div>

      <div class="recent-section">
        <div class="recent-header">
          <h4>ğŸ•’ Recent History</h4>
          <button id="clearAllBtn" class="hidden btn-link" onclick="clearAllHistory()">Clear All</button>
        </div>
        <div id="recentQuizzesList"></div>
      </div>
    </div>

    <div id="quiz" class="card hidden">
      <div class="quiz-header">
        <div class="header-left">
          <span id="questionCounter" class="badge">Question 1</span>
          <span id="questionTimer" class="timer-pill">00s</span>
        </div>
        <div class="header-right">
          <span id="totalTimer" class="total-time">Total: 00:00</span>
          <button class="btn btn-exit" onclick="exitSession()">ğŸ’¾ Save & Exit</button>
        </div>
      </div>
      
      <div class="progress-bar-bg"><div id="progressBar"></div></div>
      
      <h2 id="question"></h2>
      
      <div class="options" id="optionsContainer"></div>
      
      <div id="feedback" class="hidden feedback-box">
          <div id="feedbackStatus"></div>
          <div id="feedbackBody"></div>
          <div id="feedbackLink"></div>
      </div>
      
      <div class="controls">
        <button class="btn btn-nav-secondary" onclick="prev()">â† Prev</button>
        <button id="flagBtn" class="btn btn-nav-flag" onclick="toggleFlag()">ğŸš© Flag</button>
        <div class="next-group">
            <button id="nextBtn" class="btn btn-primary" onclick="next()">Next â†’</button>
            <button id="submitBtn" class="btn btn-success hidden" onclick="finishQuiz()">Submit</button>
        </div>
      </div>
    </div>

    <div id="reportView" class="card hidden">
      <h2 class="center">ğŸ“Š Performance Analytics</h2>
      <div id="statSummary" class="stat-grid"></div>
      <div class="chart-container"><canvas id="accuracyChart"></canvas></div>
      <div class="report-footer">
        <button class="btn btn-primary" onclick="generateAnalyticPDF()">ğŸ“¥ Download PDF Report</button>
        <button class="btn btn-secondary" onclick="location.reload()">Return Home</button>
      </div>
    </div>
  </main>

  <aside id="sidebar" class="sidebar hidden">
      <div class="sidebar-section">
        <div class="sidebar-header-row">
            <span class="sidebar-title">ğŸš© Flagged (<span id="flagCount">0</span>)</span>
            <button class="btn-xs btn-secondary toggle-btn" onclick="toggleSection('flaggedList', this)">_</button>
        </div>
        <div id="flaggedList" class="sidebar-list"></div>
      </div>

      <div class="sidebar-section" style="margin-top: 20px;">
        <div class="sidebar-header-row">
            <span class="sidebar-title">â­• Pending (<span id="unattemptedCount">0</span>)</span>
            <button class="btn-xs btn-secondary toggle-btn" onclick="toggleSection('unattemptedList', this)">_</button>
        </div>
        <div id="unattemptedList" class="sidebar-list"></div>
      </div>
  </aside>
</div>
<script src="script.js"></script>
</body>
</html>